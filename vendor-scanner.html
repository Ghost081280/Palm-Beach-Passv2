<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Palm Beach Pass - Vendor Scanner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --palm-green: #2D5016;
            --ocean-blue: #006B7D;
            --sand: #FAF3E3;
            --coral: #FF6B6B;
            --gold: #D4AF37;
            --white: #FFFFFF;
            --text-dark: #1A1A1A;
            --text-light: #666666;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
            --shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #FAF3E3 0%, #FFFFFF 100%);
            min-height: 100vh;
            color: var(--text-dark);
        }

        /* Header */
        .vendor-header {
            background: linear-gradient(135deg, var(--palm-green), var(--ocean-blue));
            color: white;
            padding: 1.5rem;
            text-align: center;
            box-shadow: var(--shadow);
        }

        .vendor-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .vendor-subtitle {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        /* Scanner Container */
        .scanner-container {
            max-width: 600px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        /* Scanner Section */
        .scanner-section {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
            text-align: center;
        }

        .scanner-icon {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--palm-green), var(--ocean-blue));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 3rem;
            color: white;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .scanner-icon:hover {
            transform: scale(1.05);
        }

        .scanner-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--palm-green);
        }

        .scanner-desc {
            color: var(--text-light);
            margin-bottom: 2rem;
            line-height: 1.5;
        }

        /* Camera Section */
        .camera-section {
            background: #000;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 2rem;
            position: relative;
            aspect-ratio: 4/3;
        }

        .camera-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .camera-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .scan-frame {
            width: 200px;
            height: 200px;
            border: 3px solid var(--gold);
            border-radius: 12px;
            position: relative;
            animation: pulse 2s infinite;
        }

        .scan-frame::before,
        .scan-frame::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            border: 3px solid var(--gold);
        }

        .scan-frame::before {
            top: -3px;
            left: -3px;
            border-right: none;
            border-bottom: none;
        }

        .scan-frame::after {
            bottom: -3px;
            right: -3px;
            border-left: none;
            border-top: none;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .camera-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: white;
        }

        .camera-placeholder-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        /* Control Buttons */
        .scanner-controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-bottom: 2rem;
        }

        .control-btn {
            background: var(--ocean-blue);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            cursor: pointer;
            font-family: inherit;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .control-btn:hover {
            background: var(--palm-green);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .control-btn.active {
            background: var(--success);
        }

        .control-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        /* Manual Entry */
        .manual-entry {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .manual-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--palm-green);
        }

        .manual-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1rem;
            font-family: monospace;
            text-align: center;
            transition: border-color 0.3s;
            margin-bottom: 1rem;
        }

        .manual-input:focus {
            outline: none;
            border-color: var(--ocean-blue);
        }

        .manual-submit {
            width: 100%;
            background: var(--palm-green);
            color: white;
            border: none;
            padding: 1rem;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .manual-submit:hover {
            background: var(--ocean-blue);
        }

        /* Scan Result */
        .scan-result {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
            display: none;
        }

        .scan-result.show {
            display: block;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .result-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .result-icon.valid {
            background: var(--success);
        }

        .result-icon.invalid {
            background: var(--error);
        }

        .result-icon.expired {
            background: var(--warning);
        }

        .result-details h3 {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
        }

        .result-details.valid h3 {
            color: var(--success);
        }

        .result-details.invalid h3 {
            color: var(--error);
        }

        .result-details.expired h3 {
            color: var(--warning);
        }

        .pass-info {
            background: var(--sand);
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
        }

        .pass-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .pass-row:last-child {
            margin-bottom: 0;
        }

        .pass-label {
            font-weight: 500;
            color: var(--text-light);
        }

        .pass-value {
            font-weight: 600;
            color: var(--text-dark);
        }

        .result-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .action-btn {
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-family: inherit;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-allow {
            background: var(--success);
            color: white;
        }

        .btn-deny {
            background: var(--error);
            color: white;
        }

        .btn-neutral {
            background: var(--ocean-blue);
            color: white;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        /* Recent Scans */
        .recent-scans {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .recent-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: var(--palm-green);
        }

        .scan-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border-bottom: 1px solid #f0f0f0;
            transition: background 0.3s;
        }

        .scan-item:hover {
            background: var(--sand);
        }

        .scan-item:last-child {
            border-bottom: none;
        }

        .scan-status {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .scan-status.valid {
            background: var(--success);
        }

        .scan-status.invalid {
            background: var(--error);
        }

        .scan-info {
            flex: 1;
        }

        .scan-pass-id {
            font-family: monospace;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .scan-time {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        /* Stats Summary */
        .stats-summary {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: var(--shadow);
        }

        .stats-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: var(--palm-green);
            text-align: center;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1.5rem;
            text-align: center;
        }

        .stat-item {
            padding: 1rem;
            border-radius: 12px;
            background: var(--sand);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 600;
            color: var(--palm-green);
            margin-bottom: 0.25rem;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .scanner-container {
                margin: 1rem auto;
            }

            .scanner-section,
            .manual-entry,
            .recent-scans,
            .stats-summary {
                padding: 1.5rem;
            }

            .scanner-controls {
                flex-direction: column;
            }

            .result-actions {
                flex-direction: column;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: var(--palm-green);
            color: white;
            padding: 1rem 2rem;
            border-radius: 12px;
            box-shadow: var(--shadow);
            animation: slideInRight 0.3s ease-out;
            z-index: 1000;
        }

        .toast.error {
            background: var(--error);
        }

        .toast.success {
            background: var(--success);
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="vendor-header">
        <h1 class="vendor-title">🌴 Palm Beach Pass Scanner</h1>
        <p class="vendor-subtitle">Vendor Portal - Scan customer passes for entry</p>
    </header>

    <div class="scanner-container">
        <!-- Scanner Section -->
        <section class="scanner-section">
            <div class="scanner-icon" onclick="startCamera()">📱</div>
            <h2 class="scanner-title">QR Code Scanner</h2>
            <p class="scanner-desc">Tap the camera icon to start scanning customer QR codes</p>
            
            <!-- Camera Section -->
            <div class="camera-section" id="cameraSection">
                <video id="cameraVideo" class="camera-video" style="display: none;"></video>
                <div class="camera-placeholder" id="cameraPlaceholder">
                    <div class="camera-placeholder-icon">📹</div>
                    <p>Click "Start Camera" to begin scanning</p>
                </div>
                <div class="camera-overlay" id="cameraOverlay" style="display: none;">
                    <div class="scan-frame"></div>
                </div>
            </div>
            
            <!-- Scanner Controls -->
            <div class="scanner-controls">
                <button class="control-btn" id="cameraBtn" onclick="toggleCamera()">
                    📹 Start Camera
                </button>
                <button class="control-btn" id="flashBtn" onclick="toggleFlash()" disabled>
                    💡 Flash
                </button>
            </div>
        </section>

        <!-- Manual Entry -->
        <section class="manual-entry">
            <h3 class="manual-title">Manual Entry</h3>
            <input type="text" class="manual-input" id="manualInput" placeholder="Enter pass ID (e.g., PB001-3D-ADT-001)" maxlength="20">
            <button class="manual-submit" onclick="validateManualEntry()">Validate Pass</button>
        </section>

        <!-- Scan Result -->
        <section class="scan-result" id="scanResult">
            <div class="result-header">
                <div class="result-icon valid" id="resultIcon">✓</div>
                <div class="result-details valid" id="resultDetails">
                    <h3 id="resultTitle">Valid Pass</h3>
                    <p id="resultMessage">Pass is active and ready for entry</p>
                </div>
            </div>
            
            <div class="pass-info" id="passInfo">
                <div class="pass-row">
                    <span class="pass-label">Pass ID:</span>
                    <span class="pass-value" id="passId">PB001-3D-ADT-001</span>
                </div>
                <div class="pass-row">
                    <span class="pass-label">Pass Type:</span>
                    <span class="pass-value" id="passType">3 Day Pass - Adult</span>
                </div>
                <div class="pass-row">
                    <span class="pass-label">Status:</span>
                    <span class="pass-value" id="passStatus">Active</span>
                </div>
                <div class="pass-row">
                    <span class="pass-label">Valid Until:</span>
                    <span class="pass-value" id="passExpiry">Aug 15, 2025</span>
                </div>
                <div class="pass-row">
                    <span class="pass-label">Holder:</span>
                    <span class="pass-value" id="passHolder">Demo User</span>
                </div>
            </div>
            
            <div class="result-actions">
                <button class="action-btn btn-allow" onclick="allowEntry()">✓ Allow Entry</button>
                <button class="action-btn btn-deny" onclick="denyEntry()">✗ Deny Entry</button>
                <button class="action-btn btn-neutral" onclick="scanAnother()">🔄 Scan Another</button>
            </div>
        </section>

        <!-- Recent Scans -->
        <section class="recent-scans">
            <h3 class="recent-title">Recent Scans</h3>
            <div id="recentScansList">
                <div class="scan-item">
                    <div class="scan-status valid"></div>
                    <div class="scan-info">
                        <div class="scan-pass-id">PB001-3D-ADT-001</div>
                        <div class="scan-time">2 minutes ago - Entry allowed</div>
                    </div>
                </div>
                <div class="scan-item">
                    <div class="scan-status valid"></div>
                    <div class="scan-info">
                        <div class="scan-pass-id">PB002-7D-FAM-005</div>
                        <div class="scan-time">5 minutes ago - Entry allowed</div>
                    </div>
                </div>
                <div class="scan-item">
                    <div class="scan-status invalid"></div>
                    <div class="scan-info">
                        <div class="scan-pass-id">PB003-1D-CHD-012</div>
                        <div class="scan-time">8 minutes ago - Pass expired</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Stats Summary -->
        <section class="stats-summary">
            <h3 class="stats-title">Today's Summary</h3>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-value" id="totalScans">24</div>
                    <div class="stat-label">Total Scans</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="validScans">21</div>
                    <div class="stat-label">Valid Passes</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="invalidScans">3</div>
                    <div class="stat-label">Invalid/Expired</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="currentHour">12</div>
                    <div class="stat-label">This Hour</div>
                </div>
            </div>
        </section>
    </div>

    <script>
        let cameraStream = null;
        let isScanning = false;
        let scanHistory = [];
        let stats = {
            total: 24,
            valid: 21,
            invalid: 3,
            currentHour: 12
        };

        // Demo pass database
        const passeDatabase = {
            'PB001-3D-ADT-001': {
                type: '3 Day Pass - Adult',
                status: 'active',
                expiry: '2025-08-15',
                holder: 'Demo User',
                valid: true
            },
            'PB002-7D-FAM-005': {
                type: '7 Day Pass - Family',
                status: 'active', 
                expiry: '2025-08-20',
                holder: 'Smith Family',
                valid: true
            },
            'PB003-1D-CHD-012': {
                type: '1 Day Pass - Child',
                status: 'expired',
                expiry: '2025-08-01',
                holder: 'Jane Doe',
                valid: false
            }
        };

        // Initialize
        window.onload = function() {
            console.log('Vendor Scanner App loaded');
            updateStats();
            
            // Handle manual input enter key
            document.getElementById('manualInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    validateManualEntry();
                }
            });
        };

        // Camera functions
        async function startCamera() {
            try {
                cameraStream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        facingMode: 'environment',
                        width: { ideal: 640 },
                        height: { ideal: 480 }
                    } 
                });
                
                const video = document.getElementById('cameraVideo');
                const placeholder = document.getElementById('cameraPlaceholder');
                const overlay = document.getElementById('cameraOverlay');
                const cameraBtn = document.getElementById('cameraBtn');
                const flashBtn = document.getElementById('flashBtn');
                
                video.srcObject = cameraStream;
                video.style.display = 'block';
                placeholder.style.display = 'none';
                overlay.style.display = 'flex';
                
                cameraBtn.textContent = '⏹️ Stop Camera';
                cameraBtn.classList.add('active');
                flashBtn.disabled = false;
                
                video.play();
                isScanning = true;
                
                showToast('Camera started - Point at QR code to scan', 'success');
                
                // Simulate QR detection
                setTimeout(() => {
                    if (isScanning) {
                        simulateQRScan();
                    }
                }, 3000);
                
            } catch (error) {
                console.error('Camera access error:', error);
                showToast('Camera access denied. Please allow camera permissions.', 'error');
            }
        }

        function stopCamera() {
            if (cameraStream) {
                cameraStream.getTracks().forEach(track => track.stop());
                cameraStream = null;
            }
            
            const video = document.getElementById('cameraVideo');
            const placeholder = document.getElementById('cameraPlaceholder');
            const overlay = document.getElementById('cameraOverlay');
            const cameraBtn = document.getElementById('cameraBtn');
            const flashBtn = document.getElementById('flashBtn');
            
            video.style.display = 'none';
            placeholder.style.display = 'flex';
            overlay.style.display = 'none';
            
            cameraBtn.textContent = '📹 Start Camera';
            cameraBtn.classList.remove('active');
            flashBtn.disabled = true;
            
            isScanning = false;
        }

        function toggleCamera() {
            if (isScanning) {
                stopCamera();
            } else {
                startCamera();
            }
        }

        function toggleFlash() {
            // Flash toggle simulation
            const flashBtn = document.getElementById('flashBtn');
            if (flashBtn.textContent.includes('Flash')) {
                flashBtn.textContent = '💡 Flash On';
                showToast('Flash enabled', 'success');
            } else {
                flashBtn.textContent = '💡 Flash';
                showToast('Flash disabled', 'success');
            }
        }

        // Simulate QR code detection
        function simulateQRScan() {
            const demoPassIds = Object.keys(passeDatabase);
            const randomPassId = demoPassIds[Math.floor(Math.random() * demoPassIds.length)];
            
            showToast('QR Code detected!', 'success');
            
            setTimeout(() => {
                validatePass(randomPassId);
            }, 500);
        }

        // Manual entry validation
        function validateManualEntry() {
            const passId = document.getElementById('manualInput').value.trim().toUpperCase();
            
            if (!passId) {
                showToast('Please enter a pass ID', 'error');
                return;
            }
            
            validatePass(passId);
        }

        // Pass validation
        function validatePass(passId) {
            const pass = passeDatabase[passId];
            const resultSection = document.getElementById('scanResult');
            const resultIcon = document.getElementById('resultIcon');
            const resultDetails = document.getElementById('resultDetails');
            const resultTitle = document.getElementById('resultTitle');
            const resultMessage = document.getElementById('resultMessage');
            
            // Update pass info
            document.getElementById('passId').textContent = passId;
            
            if (pass) {
                if (pass.valid) {
                    // Valid pass
                    resultIcon.className = 'result-icon valid';
                    resultIcon.textContent = '✓';
                    resultDetails.className = 'result-details valid';
                    resultTitle.textContent = 'Valid Pass';
                    resultMessage.textContent = 'Pass is active and ready for entry';
                    
                    document.getElementById('passType').textContent = pass.type;
                    document.getElementById('passStatus').textContent = 'Active';
                    document.getElementById('passExpiry').textContent = formatDate(pass.expiry);
                    document.getElementById('passHolder').textContent = pass.holder;
                    
                    showToast('✓ Valid pass detected', 'success');
                } else {
                    // Expired pass
                    resultIcon.className = 'result-icon expired';
                    resultIcon.textContent = '⚠️';
                    resultDetails.className = 'result-details expired';
                    resultTitle.textContent = 'Expired Pass';
                    resultMessage.textContent = 'This pass has expired and cannot be used';
                    
                    document.getElementById('passType').textContent = pass.type;
                    document.getElementById('passStatus').textContent = 'Expired';
                    document.getElementById('passExpiry').textContent = formatDate(pass.expiry);
                    document.getElementById('passHolder').textContent = pass.holder;
                    
                    showToast('⚠️ Pass expired', 'error');
                }
            } else {
                // Invalid pass
                resultIcon.className = 'result-icon invalid';
                resultIcon.textContent = '✗';
                resultDetails.className = 'result-details invalid';
                resultTitle.textContent = 'Invalid Pass';
                resultMessage.textContent = 'Pass ID not found in system';
                
                document.getElementById('passType').textContent = 'Unknown';
                document.getElementById('passStatus').textContent = 'Invalid';
                document.getElementById('passExpiry').textContent = 'N/A';
                document.getElementById('passHolder').textContent = 'Unknown';
                
                showToast('✗ Invalid pass ID', 'error');
            }
            
            resultSection.classList.add('show');
            
            // Add to scan history
            addToScanHistory(passId, pass ? pass.valid : false);
            
            // Clear manual input
            document.getElementById('manualInput').value = '';
        }

        // Action handlers
        function allowEntry() {
            showToast('✓ Entry allowed - Welcome!', 'success');
            updateStatsForEntry(true);
            scanAnother();
        }

        function denyEntry() {
            showToast('✗ Entry denied', 'error');
            updateStatsForEntry(false);
            scanAnother();
        }

        function scanAnother() {
            document.getElementById('scanResult').classList.remove('show');
            
            if (isScanning) {
                setTimeout(() => {
                    simulateQRScan();
                }, 2000);
            }
        }

        // Utility functions
        function addToScanHistory(passId, isValid) {
            const scanTime = new Date();
            const scanItem = {
                passId: passId,
                valid: isValid,
                time: scanTime,
                action: isValid ? 'Entry allowed' : (passeDatabase[passId] ? 'Pass expired' : 'Invalid pass')
            };
            
            scanHistory.unshift(scanItem);
            
            // Keep only last 10 scans
            if (scanHistory.length > 10) {
                scanHistory = scanHistory.slice(0, 10);
            }
            
            updateRecentScans();
        }

        function updateRecentScans() {
            const container = document.getElementById('recentScansList');
            container.innerHTML = scanHistory.map(scan => `
                <div class="scan-item">
                    <div class="scan-status ${scan.valid ? 'valid' : 'invalid'}"></div>
                    <div class="scan-info">
                        <div class="scan-pass-id">${scan.passId}</div>
                        <div class="scan-time">${getTimeAgo(scan.time)} - ${scan.action}</div>
                    </div>
                </div>
            `).join('');
        }

        function updateStatsForEntry(allowed) {
            if (allowed) {
                stats.valid++;
            } else {
                stats.invalid++;
            }
            stats.total++;
            stats.currentHour++;
            
            updateStats();
        }

        function updateStats() {
            document.getElementById('totalScans').textContent = stats.total;
            document.getElementById('validScans').textContent = stats.valid;
            document.getElementById('invalidScans').textContent = stats.invalid;
            document.getElementById('currentHour').textContent = stats.currentHour;
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { 
                month: 'short', 
                day: 'numeric', 
                year: 'numeric' 
            });
        }

        function getTimeAgo(date) {
            const now = new Date();
            const diffMs = now - date;
            const diffMins = Math.floor(diffMs / 60000);
            
            if (diffMins < 1) return 'Just now';
            if (diffMins === 1) return '1 minute ago';
            if (diffMins < 60) return `${diffMins} minutes ago`;
            
            const diffHours = Math.floor(diffMins / 60);
            if (diffHours === 1) return '1 hour ago';
            return `${diffHours} hours ago`;
        }

        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Handle page visibility change
        document.addEventListener('visibilitychange', () => {
            if (document.hidden && isScanning) {
                stopCamera();
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && isScanning) {
                stopCamera();
            } else if (e.key === ' ' && !isScanning) {
                e.preventDefault();
                startCamera();
            }
        });
    </script>
</body>
</html>
